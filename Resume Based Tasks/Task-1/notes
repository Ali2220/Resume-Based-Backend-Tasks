üî• Task 1: Real-Time Chat Backend (Design + Code)
üß† Problem Statement

You are building a real-time chat system (similar to Flux).

Users can:

Join chat rooms

Send messages

Fetch previous messages when joining

This is backend only.

üõ† Requirements
1Ô∏è‚É£ Design MongoDB Schemas

Create Mongoose schemas for:

User

ChatRoom

Message

Minimum fields:

Message must belong to:

a user

a room

Messages should be fetchable room-wise

System should scale to thousands of messages

2Ô∏è‚É£ API Endpoints (REST)

Design endpoints for:

Create chat room

Send message

Fetch last 50 messages of a room (pagination ready)

3Ô∏è‚É£ One Real-Time Question (Very Important)

Answer this clearly:

üëâ Why do we still need REST APIs when we already have Socket.IO for chat?

‚è± Time Limit

15 minutes

‚úÖ Expected Outcome

Proper schema relationships (ref)

Scalable thinking (no embedding 10k messages in one doc)

Clean endpoint design

Clear explanation (not essay)

üßæ What I Want in Your Reply

Reply with:

User, ChatRoom, Message schemas

REST API routes (just route + purpose, full code not required)

Short answer to Socket.IO vs REST question (4‚Äì5 lines max)
===========================================================

TASK 2: Design a Rate Limiting Middleware
‚è±Ô∏è Time Limit: 15 minutes
Problem Statement:
You're building an API for a chat application (similar to your Flux project). You need to implement a rate limiting middleware to prevent abuse.
Requirements:

Limit each user to 5 requests per minute to the /api/chat endpoint
Use an in-memory approach (no Redis for this task - keep it simple)
Return appropriate HTTP status code and error message when limit is exceeded
The middleware should track requests by user ID (assume req.userId is available from authentication middleware)

Expected Outcome:
Write the middleware function in JavaScript/Node.js. Your solution should:

Track request counts per user
Reset counts after 1 minute
Block excessive requests with proper error response
Allow requests to continue if under the limit
===============================================================

TASK 3: Database Schema Design & Query Optimization
‚è±Ô∏è Time Limit: 20 minutes
Problem Statement:
You're building a messaging system similar to Slack where:

Users can join multiple workspaces
Each workspace has multiple channels
Users can send messages in channels
Messages can be threaded (replies to other messages)
You need to support @mentions of users in messages

Requirements:
Part A: Schema Design (10 minutes)
Design MongoDB schemas for this system. Include:

User schema
Workspace schema
Channel schema
Message schema

Consider:

Relationships between collections (embedded vs referenced)
Indexes for performance
Fields needed for common queries

Part B: Query Problem (10 minutes)
Write a MongoDB query (using Mongoose) to:
"Fetch the last 50 messages from a specific channel, including:

Message content and timestamp
Sender's name and avatar
If it's a reply, include the parent message content
List of mentioned users' names
Sort by newest first"

This query should be optimized - explain what indexes you'd create and why.
=============================================================================

TASK 4: Error Handling & API Design
‚è±Ô∏è Time Limit: 25 minutes
Problem Statement:
You're building a file upload API for a chat application where users can upload images/documents to channels. The API needs robust error handling and proper validation.
Scenario:
Users upload files to /api/upload endpoint. The file should be:

Validated for type (only images: jpg, png, gif and documents: pdf, docx)
Size limit: Max 5MB
Uploaded to ImageKit CDN (like in your MoodyPlayer project)
Metadata saved to MongoDB

Requirements:
Part A: Error Handling Middleware (10 minutes)
Create a centralized error handling system:

Custom Error Classes for different error types:

ValidationError (400) - Invalid input
AuthenticationError (401) - Not authenticated
AuthorizationError (403) - Not authorized
NotFoundError (404) - Resource not found
FileUploadError (422) - File upload issues


Global error handler middleware that:

Catches all errors
Formats consistent error responses
Logs errors appropriately
Handles both operational and programming errors
Returns appropriate HTTP status codes



Part B: File Upload Route with Validation (15 minutes)
Create the /api/upload route that:

Validates user is authenticated
Validates file exists in request
Validates file type (jpg, png, gif, pdf, docx only)
Validates file size (max 5MB)
Checks user has permission to upload to the channel
Handles upload failures gracefully
Returns proper success/error responses
=======================================================================

TASK 5: Authentication System & Security
‚è±Ô∏è Time Limit: 30 minutes
Problem Statement:
You're building a secure authentication system for your chat application. The system needs to handle user registration, login, token refresh, and proper security measures.

Requirements:
Part A: Secure Registration & Login (15 minutes)
Create two endpoints:
1. POST /api/auth/register

Accept: email, password, name
Validate email format and password strength (min 8 chars, 1 uppercase, 1 number)
Hash password with bcrypt (salt rounds: 10)
Check if user already exists
Create user and return JWT token
Token should expire in 7 days

2. POST /api/auth/login

Accept: email, password
Verify credentials
Return access token (15 min expiry) and refresh token (7 days)
Store refresh token in database
Set httpOnly cookies for tokens

Part B: Token Refresh & Logout (10 minutes)
3. POST /api/auth/refresh

Accept refresh token from cookie
Verify refresh token
Issue new access token
Return new access token

4. POST /api/auth/logout

Invalidate refresh token
Clear cookies
Return success message

Part C: Security Questions (5 minutes)
Answer these:

Why should you use httpOnly cookies for tokens?
What's the difference between access token and refresh token?
How would you prevent brute force login attacks?


Expected Outcome:
Files to create:

routes/authRoutes.js - All auth endpoints
middlewares/authMiddleware.js - Updated secure middleware
models/RefreshToken.js - Schema for refresh tokens
utils/tokenUtils.js - JWT helper functions